<!-- Encabezado -->
<div class="flex justify-between items-center mb-6">
  <h2 class="text-2xl font-bold text-secondary">👨‍💼 Gestión de Empleados</h2>

  <div class="dropdown dropdown-end">
    <label
      tabindex="0"
      class="btn btn-outline btn-primary btn-sm lg:btn-md flex items-center gap-2"
    >
      Opciones
      <svg
        class="w-4 h-4"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M19 9l-7 7-7-7"
        />
      </svg>
    </label>
    <ul
      tabindex="0"
      class="dropdown-content menu p-2 shadow-lg bg-base-100 rounded-xl w-56"
    >
      <li>
        <a class="hover:bg-primary transition">➕ Registrar nuevo empleado</a>
      </li>
      <li>
        <a (click)="openModal()" class="hover:bg-primary transition">
          💳 Pagar planilla
        </a>
      </li>
      <li>
        <a class="hover:bg-primary transition"> 📋 Ver Historial Pagos </a>
      </li>
    </ul>
  </div>
</div>

<!-- Card con tabla -->
<div class="card bg-base-100 shadow-lg border border-gray-100 rounded-xl">
  <div class="card-body">
    <h3 class="card-title mb-4 text-accent">📋 Lista de Empleados</h3>
    <div class="overflow-x-auto rounded-lg border border-gray-200">
      <table class="table table-zebra w-full">
        <thead>
          <tr>
            <th class="text-sm">Nombre</th>
            <th class="text-sm">Salario semanal</th>
            <th class="text-sm">CUI</th>
            <th class="text-sm">Email</th>
            <th class="text-sm">Puesto</th>
            <th class="text-sm">Área</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          @for (employee of employees(); track employee.id) {
          <tr class="hover:bg-accent-content transition">
            <td class="font-medium">{{ employee.fullName }}</td>
            <td>
              {{ employee.salary | currency : "GTQ" : "symbol" : "1.2-2" }}
            </td>
            <td>{{ employee.cui }}</td>
            <td>{{ employee.email }}</td>
            <td>{{ employee.jobPosition }}</td>
            <td>
              <span
                class="badge px-3 py-2"
                [ngClass]="
                  employee.jobArea === 'HOTEL'
                    ? 'badge-primary '
                    : 'badge-info '
                "
              >
                {{ employee.jobArea }}
              </span>
            </td>
            <td class="text-right">
              <button class="btn btn-sm btn-outline btn-primary rounded-lg">
                ✏️ Editar
              </button>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modal de Pago -->
<dialog #modalPayEmployees class="modal">
  <div class="modal-box max-w-md">
    <h3
      class="font-bold text-xl mb-4 text-center text-primary flex items-center justify-center gap-2"
    >
      💵 Pago Semanal de Planilla
    </h3>

    <div class="alert alert-info text-sm mb-4">
      <span
        >El pago se realizará a todos los trabajadores tomando en cuenta su
        salario base semanal.</span
      >
    </div>

    <div class="grid gap-4">
      <!-- Fecha inicio -->
      <div class="form-control">
        <label class="label">
          <span class="label-text font-medium">📅 Fecha de inicio</span>
        </label>
        <input
          type="date"
          class="input input-bordered w-full focus:ring-2 focus:ring-primary focus:outline-none"
          required
          [(ngModel)]="startDate"
        />
      </div>

      <!-- Fecha final -->
      <div class="form-control">
        <label class="label">
          <span class="label-text font-medium">📅 Fecha final</span>
        </label>
        <input
          type="date"
          class="input input-bordered w-full focus:ring-2 focus:ring-primary focus:outline-none"
          required
          [(ngModel)]="endDate"
        />
      </div>

      <!-- Botones -->
      <div class="modal-action flex justify-end gap-3 mt-6">
        <button
          class="btn btn-primary px-6 rounded-xl shadow-md hover:scale-105 transition-transform"
          type="submit"
          (click)="savePayroll()"
        >
          💳 Realizar Pago
        </button>
        <button
          class="btn btn-outline px-6 rounded-xl hover:bg-gray-100"
          type="button"
          (click)="modalPayEmployees.close()"
        >
          ✖ Cancelar
        </button>
      </div>
    </div>
  </div>
</dialog>
